import{r as w,C as S,c as F,b as r,w as f,d as c,e,u as m,m as V,g as n,j as x,P as E,i as a,h,t as l,F as p,k,l as y,W as v}from"./app-DeD_P_YC.js";import N from"./Admin-d4FZMdEV.js";import"./Header-DXVwB9JM.js";import"./index-DZAsz5v4.js";import"./Sidebar-EdN0_9QA.js";const T={class:"container mx-auto p-6 bg-white shadow-lg rounded-lg"},B={class:"flex justify-between items-center mb-4"},P={class:"border-b pb-4 mb-4"},W={key:0},$={key:0},R={class:"flex flex-wrap gap-4"},q=["href"],z=["src"],L={key:1,class:"text-gray-500"},U={key:2},G={key:0},H=["href"],M={key:3,class:"text-gray-500"},O=["value"],Y={__name:"WorkDetail",props:{work:Object},setup(s){const d=s,g=w([]),C=i=>{g.value=[...i.target.files]},A=()=>{if(!g.value.length)return;const i=new FormData;g.value.forEach((t,o)=>{console.log(t),i.append("files[]",t)}),v.post(route("admin.works.upload",d.work.id),i,{preserveState:!0,forceFormData:!0})},b=S({estado:d.work.estado}),u=w(null),j=()=>{v.put(route("admin.works.updateStatus",d.work.id),{estado:b.estado},{preserveState:!0})},D=()=>{u.value&&v.put(route("admin.works.reassign",d.work.id),{assigned_to:u.value},{preserveState:!0})};return(i,t)=>(r(),F(N,null,{default:f(()=>[c(m(V),{title:"Detalles del Trabajo"}),e("div",T,[e("div",B,[t[3]||(t[3]=e("h1",{class:"text-2xl font-bold"},"Detalles del Trabajo",-1)),c(m(E),{href:i.route("admin.clients.show",s.work.client.id),class:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-700"},{default:f(()=>t[2]||(t[2]=[a(" ⬅️ Volver a la Lista de Trabajos ")])),_:1},8,["href"])]),e("div",P,[e("p",null,[t[4]||(t[4]=e("strong",null,"Título:",-1)),a(" "+l(s.work.titulo),1)]),e("p",null,[t[5]||(t[5]=e("strong",null,"Descripción:",-1)),a(" "+l(s.work.descripcion),1)]),e("p",null,[t[6]||(t[6]=e("strong",null,"Estado:",-1)),a(" "+l(s.work.estado),1)]),e("p",null,[t[7]||(t[7]=e("strong",null,"Cliente:",-1)),a(" "+l(s.work.client.user.name),1)]),e("p",null,[t[8]||(t[8]=e("strong",null,"Empresa:",-1)),a(" "+l(s.work.client.empresa||"No especificada"),1)]),s.work.assignedAdmin?(r(),n("p",W,[t[9]||(t[9]=e("strong",null,"Asignado a:",-1)),a(" "+l(s.work.assignedAdmin.name),1)])):h("",!0)]),t[11]||(t[11]=e("h2",{class:"text-xl font-semibold mt-4"},"📂 Archivos Adjuntos",-1)),s.work.archivos?(r(),n("div",$,[e("div",R,[(r(!0),n(p,null,k(s.work.archivos,o=>(r(),n("div",{key:o},[e("a",{href:`/storage/${o}`,target:"_blank",class:"text-blue-500 hover:underline"},[e("img",{src:`/storage/${o}`,class:"w-32 h-auto rounded shadow"},null,8,z)],8,q)]))),128))])])):(r(),n("p",L,"No hay archivos adjuntos.")),t[12]||(t[12]=e("h2",{class:"text-xl font-semibold mt-4"},"🔄 Historial de Cambios",-1)),s.work.change_requests.length?(r(),n("ul",U,[(r(!0),n(p,null,k(s.work.change_requests,o=>(r(),n("li",{key:o.id},[e("p",null,[e("strong",null,"📝 "+l(o.descripcion),1)]),o.archivo?(r(),n("p",G,[e("a",{href:`/storage/${o.archivo}`,target:"_blank",class:"text-blue-500 hover:underline"}," 📂 Ver Archivo ",8,H)])):h("",!0)]))),128))])):(r(),n("p",M,"No hay cambios registrados.")),t[13]||(t[13]=e("h2",{class:"text-xl font-semibold mt-4"},"📤 Subir Renders",-1)),e("input",{type:"file",multiple:"",onChange:C,class:"border p-2 rounded w-full"},null,32),e("button",{onClick:A,class:"mt-2 px-4 py-2 bg-indigo-500 text-white rounded hover:bg-indigo-700"}," Subir Archivos "),t[14]||(t[14]=e("h2",{class:"text-xl font-semibold mt-4"},"🔄 Cambiar Estado",-1)),x(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>m(b).estado=o),class:"border p-2 rounded w-full"},t[10]||(t[10]=[e("option",{value:"pendiente"},"Pendiente",-1),e("option",{value:"en_progreso"},"En Progreso",-1),e("option",{value:"esperando_confirmacion"},"Esperando Confirmación",-1),e("option",{value:"finalizado"},"Finalizado",-1)]),512),[[y,m(b).estado]]),e("button",{onClick:j,class:"mt-2 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-700"}," Guardar Cambios "),t[15]||(t[15]=e("h2",{class:"text-xl font-semibold mt-4"},"👷 Reasignar Trabajo",-1)),x(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>u.value=o),class:"border p-2 rounded w-full"},[(r(!0),n(p,null,k(s.work.admins,o=>(r(),n("option",{key:o.id,value:o.id},l(o.name),9,O))),128))],512),[[y,u.value]]),e("button",{onClick:D,class:"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-700"}," Asignar a otro Admin ")])]),_:1}))}};export{Y as default};
